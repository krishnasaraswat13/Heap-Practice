
import java.util.*;
class Solution {
    public String reorganizeString(String s) {
        int n = s.length();
        
        // Store frequencies of all characters in string
        Map<Character, Integer> freq = new HashMap<>();
        for (char c : s.toCharArray())
            freq.put(c, freq.getOrDefault(c, 0) + 1);
        
        // Insert all characters with their frequencies
        // into a priority_queue
        PriorityQueue<Map.Entry<Character, Integer>> pq = 
            new PriorityQueue<>((a, b) -> b.getValue() - a.getValue());
        pq.addAll(freq.entrySet());
        
        StringBuilder res = new StringBuilder();
        
        // Work as the previous visited element
        // Initial previous element be '#' and its frequency '-1'
        Map.Entry<Character, Integer> prev = new AbstractMap.SimpleEntry<>('#', -1);
        
        while (!pq.isEmpty()) {
            // Pop top element from queue and add it
            // to string.
            Map.Entry<Character, Integer> p = pq.poll();
            res.append(p.getKey());
            
            // If frequency of previous character is less
            // than zero that means it is useless, we
            // need not to push it
            if (prev.getValue() > 0)
                pq.offer(prev);
            
            // Make current character as the previous 'char'
            // decrease frequency by 'one'
            prev = new AbstractMap.SimpleEntry<>(p.getKey(), p.getValue() - 1);
        }
        
        // If length of the resultant string and original
        // string is not same then string is not valid
        if (res.length() != n)
            return "";
        
        // Valid String
        return res.toString();
    }
}

//The idea is to place the highest frequency character first.
//  We use a priority queue (max heap) and put all characters 
// and ordered by their frequencies (highest frequency character 
// at root). One by one take the highest frequency character from 
// the heap and add it to result. After adding it, just decrease 
// the frequency of the character and then temporarily move this 
// character out of priority queue so that it is not picked again next time.